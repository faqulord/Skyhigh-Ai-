<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Skyhigh AI | Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background-color: #050505; color: white; font-family: sans-serif; }
        .tech-card { background: #0f0f11; border: 1px solid #27272a; border-radius: 16px; overflow: hidden; }
        
        /* CHAT ST√çLUS */
        .ai-message { 
            background: #18181b; border-left: 2px solid #a855f7; 
            padding: 12px; margin-bottom: 12px; border-radius: 0 12px 12px 0;
            font-size: 13px; line-height: 1.5; color: #e4e4e7;
            opacity: 0; animation: slideIn 0.3s forwards;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2);
        }
        .ai-message strong { color: #fff; font-weight: 700; }
        @keyframes slideIn { from { transform: translateX(-10px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        /* ELEMZ≈ê LOG */
        .analyzing-text { font-family: monospace; font-size: 10px; color: #22c55e; margin-bottom: 2px; }
        
        /* CIKLUS NAPL√ì */
        .history-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #27272a; font-size: 12px; }
        .history-item:last-child { border-bottom: none; }
        
        .btn-activate { background: linear-gradient(135deg, #22c55e, #16a34a); color: black; font-weight: 800; padding: 14px; width: 100%; display: block; text-align: center; text-transform: uppercase; border-radius: 8px; box-shadow: 0 0 20px rgba(34,197,94,0.3); }
        .admin-btn { position: fixed; bottom: 20px; right: 20px; background: gold; color: black; padding: 10px 20px; font-weight: 900; border-radius: 50px; text-transform: uppercase; z-index: 50; }
    </style>
</head>
<body class="p-4 md:p-6 max-w-7xl mx-auto pb-24">

    <header class="flex justify-between items-center mb-6 border-b border-zinc-800 pb-4">
        <div>
            <h1 class="text-xl font-black uppercase italic">Skyhigh<span class="text-purple-500">.AI</span></h1>
            <p class="text-[10px] text-zinc-500">OPERATOR: <%= user.fullname.toUpperCase() %></p>
        </div>
        <div>
            <% if (user.hasLicense) { %>
                <div class="text-right">
                    <span class="text-green-500 text-xs font-bold uppercase animate-pulse">‚óè Rendszer Akt√≠v</span>
                    <p class="text-[10px] text-zinc-500">Ciklus v√©ge: <%= user.licenseExpires ? user.licenseExpires.toISOString().substring(0,10) : '√ñr√∂k√∂s' %></p>
                </div>
            <% } else { %>
                <span class="text-red-500 text-xs font-bold uppercase">‚óè Inakt√≠v</span>
            <% } %>
            <a href="/logout" class="block text-right text-[10px] text-zinc-600 hover:text-white uppercase mt-1">Kijelentkez√©s</a>
        </div>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <div class="lg:col-span-8 tech-card flex flex-col h-[600px] relative">
            <div class="p-4 border-b border-zinc-800 bg-zinc-900/50 flex justify-between items-center">
                <span class="text-xs font-bold text-zinc-300 uppercase"><i class="fas fa-robot mr-2 text-purple-500"></i> Skyhigh Neural Net</span>
                <span class="text-[10px] text-zinc-600">Online</span>
            </div>
            
            <div id="chatBox" class="flex-1 overflow-y-auto p-4 bg-[#0a0a0a]"></div>

            <div class="p-3 border-t border-zinc-800 bg-zinc-900/30">
                <input type="text" placeholder="√çrj az elemz≈ënek..." class="w-full bg-black border border-zinc-800 rounded p-3 text-xs text-white focus:border-purple-500 outline-none">
            </div>
        </div>

        <div class="lg:col-span-4 space-y-4">
            <% if (user.hasLicense) { %>
                
                <div class="tech-card p-6 border border-green-500/30 bg-green-900/5">
                    <h3 class="text-[10px] text-zinc-400 uppercase font-bold">Havi Ciklus C√©l</h3>
                    <p class="text-3xl font-black text-white animate-pulse">+30% Profit</p>
                    <p class="text-[10px] text-green-400 mt-1">Stabil n√∂veked√©si p√°lya.</p>
                </div>

                <div class="tech-card p-6">
                    <h3 class="text-[10px] text-zinc-400 uppercase font-bold mb-4">Napi Master Tipp <span class="text-purple-500">@AI_VERIFIED</span></h3>
                    
                    <div id="analysisLog" class="hidden mb-4 p-2 bg-black rounded border border-zinc-800 h-24 overflow-y-auto"></div>

                    <div id="tipResult" class="text-center hidden animate-fade-in">
                        <div class="bg-zinc-800/50 p-2 rounded mb-2">
                            <span class="text-[10px] text-zinc-400 block"><%= new Date().toLocaleDateString('hu-HU') %></span>
                            <p class="text-lg font-black text-white">REAL MADRID <span class="text-zinc-500">vs</span> BARCELONA</p>
                        </div>
                        <div class="inline-block bg-green-500 text-black px-4 py-2 rounded font-bold text-sm uppercase shadow-[0_0_15px_rgba(34,197,94,0.5)]">
                            Tipp: Mindk√©t csapat l≈ë g√≥lt (1.65)
                        </div>
                        <p class="text-[10px] text-zinc-500 mt-2">Kock√°zat: Alacsony | Biztons√°g: 94%</p>
                    </div>
                    
                    <div id="scanBtnArea" class="text-center">
                        <button onclick="startAnalysis()" class="w-full bg-zinc-800 hover:bg-zinc-700 text-white text-xs font-bold py-3 px-4 rounded uppercase border border-zinc-600 transition hover:border-white">
                            <i class="fas fa-satellite-dish mr-2 animate-pulse"></i> Elemz√©s Futtat√°sa
                        </button>
                    </div>
                </div>

                <div class="tech-card p-0">
                    <div class="p-4 border-b border-zinc-800 bg-zinc-900/50">
                        <h3 class="text-xs font-bold text-zinc-300 uppercase"><i class="fas fa-calendar-alt mr-2"></i> Havi Ciklus Napl√≥</h3>
                    </div>
                    <div class="p-2" id="historyList">
                        </div>
                </div>

            <% } else { %>
                
                <div class="tech-card p-0 relative overflow-hidden h-64">
                    <div class="absolute inset-0 bg-[url('https://media.giphy.com/media/xT9IgzoKnwFNmISR8I/giphy.gif')] bg-cover opacity-10"></div>
                    <div class="absolute inset-0 flex flex-col items-center justify-center bg-black/80 p-6 text-center">
                        <i class="fas fa-lock text-red-500 text-3xl mb-3"></i>
                        <h3 class="text-white font-bold text-sm mb-1">Pr√©mium Adat Z√°rolva</h3>
                        <p class="text-xs text-zinc-400 mb-4 max-w-[200px]">A mai 94%-os tipp elk√©sz√ºlt. A profit el√©r√©s√©hez aktiv√°ld a licencet.</p>
                        <a href="/fizetes" class="btn-activate">
                            Tipp Felold√°sa <i class="fas fa-unlock ml-2"></i>
                        </a>
                    </div>
                </div>

                <div class="tech-card p-4 flex items-center gap-3 opacity-60">
                    <i class="fas fa-history text-zinc-500"></i>
                    <div>
                        <p class="text-[10px] text-zinc-400 uppercase">Tegnapi eredm√©ny</p>
                        <p class="text-xs font-bold text-white">NYERTES ‚úÖ (Profit realiz√°lva)</p>
                    </div>
                </div>

            <% } %>
        </div>
    </div>

    <% if (isAdmin) { %> <a href="/admin" class="admin-btn">üëë ADMIN</a> <% } %>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const chatBox = document.getElementById('chatBox');
            const hasLicense = <%= user.hasLicense %>;
            const userName = "<%= user.fullname.split(' ')[0] %>";
            
            function botSay(text, delay) {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = 'ai-message';
                    div.innerHTML = `<strong class="text-purple-400 block text-[9px] uppercase mb-1 tracking-widest">Skyhigh AI</strong>${text}`;
                    chatBox.appendChild(div);
                    chatBox.scrollTop = chatBox.scrollHeight;
                }, delay);
            }

            // --- A T√ñRT√âNET GENER√ÅL√ÅSA (Simul√°lt Ciklus Napl√≥) ---
            if(hasLicense) {
                const historyList = document.getElementById('historyList');
                const today = new Date();
                
                // MAI NAP
                let html = `
                    <div class="history-item bg-zinc-800/30">
                        <span class="text-zinc-300 font-bold">${today.toLocaleDateString('hu-HU')}</span>
                        <span class="text-yellow-500 font-bold text-[10px] uppercase"><i class="fas fa-spinner fa-spin mr-1"></i> Folyamatban</span>
                    </div>`;
                
                // ELM√öLT 4 NAP (Hogy l√°ssa a z√∂ldet)
                for(let i=1; i<=4; i++) {
                    let d = new Date();
                    d.setDate(d.getDate() - i);
                    html += `
                    <div class="history-item">
                        <span class="text-zinc-500">${d.toLocaleDateString('hu-HU')}</span>
                        <span class="text-green-500 font-bold text-[10px] uppercase">NYERTES ‚úÖ</span>
                    </div>`;
                }
                historyList.innerHTML = html;
            }

            // --- SZ√ñVEGEZ√âS ---
            if (hasLicense) {
                // AKT√çV √úGYF√âLNEK
                botSay(`√údv√∂z√∂llek a Bels≈ë K√∂rben, ${userName}. A rendszered √©les√≠tve.`, 500);
                
                botSay(`Figyelj j√≥l, mert ezt csak egyszer mondom el: <strong>Napi EGYETLEN EGY profi tippet kapsz t≈ëlem.</strong> Nem t√∂bbet.`, 2000);
                
                botSay(`Ezt az egy tippet a jobb oldalon, az <strong>'Elemz√©sek'</strong> men√ºben tal√°lod alul, mindig az aktu√°lis d√°tummal ell√°tva.`, 5000);
                
                botSay(`A feladatod k√∂telez≈ë √©rv√©ny≈±: <strong>Ezt a tippet minden nap meg kell tenned!</strong> Nincs kifog√°s, nincs kihagyott nap.`, 8000);
                
                botSay(`√çrd meg nekem most: Melyik irod√°n√°l (TippmixPro, Bet365, Unibet) vagy lott√≥z√≥ban j√°tszol?`, 11000);
                
                botSay(`A c√©lunk a <strong>fix havi profit</strong>. Ha k√∂veted az utas√≠t√°sokat, a h√≥napot pluszban z√°rjuk, √©s j√∂v≈ë h√≥napban m√°r emelt t√©ttel indulunk. Kezdhetj√ºk?`, 14000);

            } else {
                // INGYENES √úGYF√âLNEK
                botSay(`√údv√∂z√∂llek, ${userName}. A Skyhigh AI vagyok.`, 500);
                botSay(`Lefuttattam a mai glob√°lis szkennel√©st. Tal√°ltam egy <strong class="text-white">kiemelt, alacsony kock√°zat√∫</strong> lehet≈ës√©get.`, 2000);
                botSay(`A garant√°lt profit el√©r√©s√©hez √©s a strat√©gia megkezd√©s√©hez aktiv√°ld a rendszert a jobb oldali gombbal.`, 4000);
            }
        });

        // "VAL√ìDI" ELEMZ√âS SZIMUL√ÅTOR
        function startAnalysis() {
            const btnArea = document.getElementById('scanBtnArea');
            const logArea = document.getElementById('analysisLog');
            const resultArea = document.getElementById('tipResult');
            
            btnArea.style.display = 'none';
            logArea.style.display = 'block';

            const logs = [
                "Csatlakoz√°s a glob√°lis odds szerverekhez...",
                "Bet365 / TippmixPro adatb√°zis szinkroniz√°l√°sa...",
                "S√©r√ºltek list√°j√°nak ellen≈ërz√©se...",
                "Volatilit√°s index sz√°m√≠t√°sa...",
                "<span style='color:#a855f7'>OPTIM√ÅLIS BEMENETI PONT TAL√ÅLVA...</span>",
                "Elemz√©s v√©gleges√≠t√©se..."
            ];

            let delay = 0;
            logs.forEach((log, index) => {
                setTimeout(() => {
                    logArea.innerHTML += `<div class="analyzing-text">> ${log}</div>`;
                    logArea.scrollTop = logArea.scrollHeight;
                }, delay);
                delay += 800;
            });

            setTimeout(() => {
                logArea.style.display = 'none';
                resultArea.style.display = 'block';
            }, delay + 500);
        }
    </script>
</body>
</html>